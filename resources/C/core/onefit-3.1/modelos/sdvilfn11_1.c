/******************************************************************************/
/*				SDVILFN11_1.C				      */
/******************************************************************************/
#include <math.h>
#include <stdio.h>

#define	C	0.569504e-12
#define ndt1	64
#define Ndt	ndt1-1

/*
lsd = 11
asd = 0.5
r2sd2 = 1
DllsDT = 1
*/

static double	jwdev[][3]={
1.000000e-02,5.976489e+00,0.000000e+00,
1.414214e-02,5.976421e+00,-6.418309e+00,
1.732051e-02,5.976306e+00,-7.746660e+00,
2.000000e-02,5.976146e+00,-1.120627e+01,
2.236068e-02,5.975940e+00,-1.337793e+01,
2.449490e-02,5.975689e+00,-1.656239e+01,
2.645751e-02,5.975392e+00,-1.939700e+01,
2.828427e-02,5.975049e+00,-2.140590e+01,
3.000000e-02,5.974661e+00,-2.516600e+01,
3.162278e-02,5.974227e+00,-2.652177e+01,
4.472136e-02,5.967413e+00,-5.305037e+01,
5.477226e-02,5.956184e+00,-7.745127e+01,
6.324555e-02,5.940731e+00,-9.871530e+01,
7.071068e-02,5.921305e+00,-1.162777e+02,
7.745967e-02,5.898211e+00,-1.296761e+02,
8.366600e-02,5.871796e+00,-1.387264e+02,
8.944272e-02,5.842435e+00,-1.435968e+02,
9.486833e-02,5.810517e+00,-1.442326e+02,
1.000000e-01,5.776437e+00,-1.413045e+02,
1.048809e-01,5.740582e+00,-1.351304e+02,
1.095445e-01,5.703324e+00,-1.263277e+02,
1.140175e-01,5.665013e+00,-1.154304e+02,
1.183216e-01,5.625972e+00,-1.031230e+02,
1.224745e-01,5.586493e+00,-8.976580e+01,
1.264911e-01,5.546836e+00,-7.620735e+01,
1.303840e-01,5.507227e+00,-6.215052e+01,
1.341641e-01,5.467864e+00,-4.830921e+01,
1.378405e-01,5.428911e+00,-3.714370e+01,
1.414214e-01,5.390506e+00,-1.709494e+01,
1.732051e-01,5.051673e+00,5.439680e+01,
2.000000e-01,4.799026e+00,5.823359e+01,
2.236068e-01,4.609502e+00,4.556270e+01,
2.449490e-01,4.460045e+00,3.196143e+01,
2.645751e-01,4.335713e+00,2.119889e+01,
2.828427e-01,4.227511e+00,1.298348e+01,
3.000000e-01,4.130032e+00,8.331159e+00,
3.162278e-01,4.039972e+00,7.048205e-01,
4.472136e-01,3.314051e+00,-2.260686e+00,
5.477226e-01,2.746684e+00,3.348987e+00,
6.324555e-01,2.290002e+00,6.115028e+00,
7.071068e-01,1.922747e+00,7.866717e+00,
7.745967e-01,1.627361e+00,8.361660e+00,
8.366600e-01,1.388903e+00,8.216765e+00,
8.944272e-01,1.195194e+00,7.706821e+00,
9.486833e-01,1.036634e+00,7.071435e+00,
1.000000e+00,9.057832e-01,6.316952e+00,
1.224745e+00,5.064211e-01,3.501049e+00,
1.414214e+00,3.182346e-01,2.017658e+00,
1.581139e+00,2.166783e-01,1.243264e+00,
1.732051e+00,1.562843e-01,8.090292e-01,
1.870829e+00,1.176991e-01,5.518807e-01,
2.000000e+00,9.165674e-02,3.911117e-01,
2.121320e+00,7.330274e-02,2.862343e-01,
2.236068e+00,5.990733e-02,2.151960e-01,
2.345208e+00,4.984544e-02,1.655528e-01,
2.449490e+00,4.210327e-02,1.299129e-01,
2.549510e+00,3.602302e-02,1.036526e-01,
2.645751e+00,3.116342e-02,8.415696e-02,
2.738613e+00,2.721987e-02,6.844845e-02,
2.828427e+00,2.397678e-02,5.930546e-02,
2.915476e+00,2.127822e-02,4.048509e-02,
3.000000e+00,1.900920e-02,6.957132e-02,
3.082207e+00,1.708346e-02,-7.428024e-02,
3.162278e+00,1.543530e-02,4.425950e-01
};

/******************************************************************************/
/*									      */
/******************************************************************************/
double sdvilfN11_1(I,d,n,t,w,delta)
double I,d,n,t,w,delta;
{
	int	j,i,p;
	double	wt,m,af,*x,*y,*y2,*xx,*yy,ypn;
	double	*dvector();
	void	free_dvector(),dsplint(),dpolint();

	x  = dvector(1,Ndt+1);
	y  = dvector(1,Ndt+1);
	y2 = dvector(1,Ndt+1);

	wt = sqrt(w*t);
	for(j=0,i= -1;j<=Ndt;j++) {
		x[j+1] = jwdev[j][0];
		y[j+1] = jwdev[j][1];
		y2[j+1]= jwdev[j][2];
		if(wt<=x[j+1] && i== -1) i=j+1;
	}
	switch(i) {
		case 1:
			dpolint(x,y,2,wt,&af,&m);
			break;
		case -1:
			af = y[Ndt+1]*x[Ndt+1]*x[Ndt+1]/(w*w);
/*
			xx = &x[Ndt];
			yy = &y[Ndt];
			dpolint(xx-1,yy-1,2,wt,&af,&m);
*/
			break;
		default:
			dsplint(x,y,y2,Ndt+1,wt,&af);
			break;
	}
	free_dvector(x,1,Ndt+1);
	free_dvector(y,1,Ndt+1);
	free_dvector(y2,1,Ndt+1);

	af = 1.5*I*(I+1)*n*C*t/(d*d*d) * af;
	return af;
}
/******************************************************************************/
/*									      */
/******************************************************************************/
