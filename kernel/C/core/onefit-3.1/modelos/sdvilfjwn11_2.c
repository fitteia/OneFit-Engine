/******************************************************************************/
/*				SDVILFJWN11_2.C				      */
/******************************************************************************/
#include <math.h>
#include <stdio.h>

#define	C	0.569504e-12
#define ndt1	46
#define Ndt	ndt1-1
#define pi      3.1415

static double	jwdev[][7]={
1.000000e-02,4.803098e+00,0.000000e+00,  8.010913e-01,0.000000e+00,  4.748428e+00,0.000000e+00,
1.414214e-02,4.802784e+00,-2.863239e+01, 8.010652e-01,-2.339537e+00, 4.748416e+00,-1.427822e+00,
1.732051e-02,4.802260e+00,-3.622620e+01, 8.010219e-01,-3.045635e+00, 4.748394e+00,-1.020516e+00,
2.000000e-02,4.801528e+00,-5.019998e+01, 8.009612e-01,-4.128988e+00, 4.748365e+00,-2.579874e+00,
2.236068e-02,4.800588e+00,-6.223835e+01, 8.008833e-01,-5.206193e+00, 4.748326e+00,-2.306887e+00,
2.449490e-02,4.799441e+00,-7.377057e+01, 8.007881e-01,-6.135931e+00, 4.748279e+00,-2.895691e+00,
2.645751e-02,4.798090e+00,-8.576309e+01, 8.006758e-01,-7.281795e+00, 4.748224e+00,-3.750353e+00,
2.828427e-02,4.796536e+00,-9.807622e+01, 8.005463e-01,-8.100121e+00, 4.748160e+00,-4.357114e+00,
3.000000e-02,4.794780e+00,-1.079256e+02, 8.003999e-01,-9.287103e+00, 4.748087e+00,-4.287176e+00,
3.162278e-02,4.792826e+00,-1.201220e+02, 8.002365e-01,-1.002785e+01, 4.748006e+00,-4.991715e+00,
4.472136e-02,4.762995e+00,-2.082684e+02, 7.976988e-01,-1.893054e+01, 4.746729e+00,-1.004195e+01,
5.477226e-02,4.717206e+00,-2.441286e+02, 7.936363e-01,-2.536200e+01, 4.744606e+00,-1.513146e+01,
6.324555e-02,4.660146e+00,-2.280628e+02, 7.882739e-01,-2.857274e+01, 4.741644e+00,-1.989024e+01,
7.071068e-02,4.596600e+00,-1.783254e+02, 7.818823e-01,-2.870776e+01, 4.737857e+00,-2.465992e+01,
7.745967e-02,4.530666e+00,-1.141643e+02, 7.747469e-01,-2.621879e+01, 4.733257e+00,-2.907501e+01,
8.366600e-02,4.465400e+00,-5.120558e+01, 7.671409e-01,-2.199505e+01, 4.727862e+00,-3.324898e+01,
8.944272e-02,4.402819e+00,5.540618e+00,  7.593068e-01,-1.625784e+01, 4.721692e+00,-3.731342e+01,
9.486833e-02,4.344079e+00,3.925455e+01,  7.514456e-01,-1.202066e+01, 4.714770e+00,-4.022726e+01,
1.000000e-01,4.289708e+00,1.030009e+02,  7.437141e-01,-8.362225e-01, 4.707120e+00,-4.634373e+01,
1.414214e-01,3.946517e+00,9.819784e+01,  6.852288e-01,1.708129e+01,  4.597305e+00,-5.893676e+01,
1.732051e-01,3.783983e+00,1.214736e+01,  6.543730e-01,5.685091e+00,  4.450509e+00,-3.951609e+01,
2.000000e-01,3.677106e+00,8.233005e+01,  6.348491e-01,9.107034e+00,  4.296332e+00,-1.154752e+01,
2.236068e-01,3.608416e+00,-9.111553e+01, 6.213276e-01,-5.726327e+00, 4.152660e+00,9.759141e+00,
2.449490e-01,3.526532e+00,3.213114e+01,  6.080501e-01,1.746406e-01,  4.026554e+00,2.150287e+01,
2.645751e-01,3.453124e+00,-5.587913e+00, 5.945901e-01,-1.397443e+01, 3.918700e+00,2.598235e+01,
2.828427e-01,3.385632e+00,3.666354e+00,  5.833310e-01,8.060817e+01,  3.827033e+00,2.590828e+01,
3.000000e-01,3.322747e+00,1.100066e+00,  5.837895e-01,-9.310269e+01, 3.748737e+00,2.432260e+01,
3.162278e-01,3.263658e+00,4.629542e-01,  5.715041e-01,8.057542e+00,  3.681122e+00,1.924290e+01,
4.472136e-01,2.797562e+00,2.618556e+00,  4.877261e-01,-1.196491e+00, 3.265749e+00,-6.669878e-01,
5.477226e-01,2.453244e+00,-4.748353e+00, 4.331034e-01,7.496715e-01,  2.979945e+00,-2.451195e+00,
6.324555e-01,2.177313e+00,2.964138e+01,  3.891861e-01,-7.708086e-02, 2.723070e+00,-1.804781e+00,
7.071068e-01,2.017366e+00,-3.165480e+01, 3.514804e-01,5.400456e-01,  2.486432e+00,-6.293510e-01,
7.745967e-01,1.806673e+00,1.349235e+01,  3.184214e-01,-8.333275e-01, 2.269301e+00,4.400387e-01,
8.366600e-01,1.627528e+00,8.472064e-01,  2.872485e-01,1.689215e+00,  2.071236e+00,1.351355e+00,
8.944272e-01,1.473158e+00,4.237974e+00,  2.616723e-01,7.018932e-02,  1.891446e+00,2.127607e+00,
9.486833e-01,1.338735e+00,3.130438e+00,  2.389454e-01,5.507186e-01,  1.728846e+00,2.539759e+00,
1.000000e+00,1.220722e+00,3.435032e+00,  2.186853e-01,4.748966e-01,  1.582162e+00,3.493048e+00,
1.414214e+00,5.579383e-01,2.024857e+00,  9.936672e-02,4.105354e-01,  7.167672e-01,2.975232e+00,
1.732051e+00,3.018369e-01,1.191174e+00,  5.353425e-02,2.057109e-01,  3.849254e-01,1.473096e+00,
2.000000e+00,1.847388e-01,6.469820e-01,  3.285350e-02,1.143050e-01,  2.347243e-01,8.566696e-01,
2.236068e+00,1.234299e-01,3.917949e-01,  2.197818e-02,6.919467e-02,  1.565049e-01,4.957268e-01,
2.449490e+00,8.784984e-02,2.484758e-01,  1.565352e-02,4.411860e-02,  1.112547e-01,3.188105e-01,
2.645751e+00,6.553718e-02,1.576157e-01,  1.168262e-02,2.799448e-02,  8.293326e-02,2.001693e-01,
2.828427e+00,5.068720e-02,1.432179e-01,  9.037923e-03,2.548668e-02,  6.410827e-02,1.819930e-01,
3.000000e+00,4.033163e-02,-2.712301e-02, 7.192788e-03,-4.845249e-03, 5.099222e-02,-3.424293e-02,
3.162278e+00,3.283482e-02,4.836976e-01,  5.856581e-03,8.616893e-02,  4.150290e-02,6.128982e-01
};

/******************************************************************************/
/*									      */
/******************************************************************************/
double sdvilfjwN11_2(I,d,n,t,w,delta)
double I,d,n,t,w,delta;
{
	int	j;
	double	B,D,wt,m,j1,j2,af;
	double	fij(),jwN11();

	if(delta == 0.0){
		af = jwN11(1,t,w) + jwN11(2,t,2*w);
	}
	else {
		j1 = fij(1,0,delta)*jwN11(0,t,w)+
		     fij(1,1,delta)*jwN11(1,t,w)+
		     fij(1,2,delta)*jwN11(2,t,w);
		j2 = fij(2,0,delta)*jwN11(0,t,2*w)+
		     fij(2,1,delta)*jwN11(1,t,2*w)+
		     fij(2,2,delta)*jwN11(2,t,2*w);
		af = j1 + j2;		
	}
	af = 1.5*I*(I+1)*n*C*t/(d*d*d) * af;
	return af;
}
/******************************************************************************/
/*									      */
/******************************************************************************/
double sdvilfjwN11_2_poli(I,d,n,t,w)
double I,d,n,t,w;
{
	int	j;
	double	B,D,wt,m,j1,j2,af;
	double	fij(),jwN11();

	j1 = 1.0/30.0*jwN11(0,t,w)+
	  12.0/30.0*jwN11(1,t,w)+
	  3.0/30.0*jwN11(2,t,w);
	j2 = 4.0/30.0*jwN11(0,t,2*w)+
	  48.0/30.0*jwN11(1,t,2*w)+
	  12.0/30.0*jwN11(2,t,2*w);
	af = j1 + j2;		
	
	af = 1.5*I*(I+1)*n*C*t/(d*d*d) * af;
	return af;
}
/******************************************************************************/
/*									      */
/******************************************************************************/
double jwN11(k,t,w)
int	k;
double t,w;
{
	int	j,i=-1,p,l=-1;
	double	wt,m,af,*x,*y,*y2,*xx,*yy,ypn;
	double	*dvector();
	void	free_dvector(),dsplint(),dpolint();

	wt = sqrt(w*t);

	x  = dvector(1,Ndt+1);
	y  = dvector(1,Ndt+1);
	y2 = dvector(1,Ndt+1);

	for(j=0;j<=Ndt;j++) {
		x[j+1] = jwdev[j][0];
		if(wt<=x[j+1] && i== -1) {
		  i=j+1;
		  l=i;
		}
		y[j+1] = jwdev[j][2*k+1];
		y2[j+1]= jwdev[j][2*k+2];
	}

	switch(i) {
		case 1:
			dpolint(x,y,2,wt,&af,&m);
			break;
		case -1:
			af = y[Ndt+1]*x[Ndt+1]*x[Ndt+1]/(w*w);

/*
			xx = &x[Ndt];
			yy = &y[Ndt];
			dpolint(xx-1,yy-1,2,wt,&af,&m);
*/
			break;
		default:
			dsplint(x,y,y2,Ndt+1,wt,&af);

			break;
	}

	free_dvector(x,1,Ndt+1);
	free_dvector(y,1,Ndt+1);
	free_dvector(y2,1,Ndt+1);

	return af;
}
/******************************************************************************/
/*									      */
/******************************************************************************/
double	jwNd11(i,t,w,delta)
int	i;
double	t,w,delta;
{
	int	j;
	double	af,jwN11(),fij();

	for(j=0,af=0.0;j<=2;j++) af += fij(i,j,delta)*jwN11(j,t,w);
	return af;
}
/******************************************************************************/
/*									      */
/******************************************************************************/
double t1roN11(I,d,n,t,w,w0,delta)
double I,d,n,t,w,w0,delta;
/* B*(J0(2*w1)+10*J1(w0)+J2(2*w0) */
{
	int	j;
	double	B,D,wt,w0t,w2t,m,J0,J1,J2,af;
	double	jwNd11();

	J0 = jwNd11(0,t,2*w,delta);
	J1 = jwNd11(1,t,w0,delta);
	J2 = jwNd11(2,t,2*w0,delta);
	
/*	printf("J0=%lg J1=%lg J2=%lg\n",J0,J1,J2);	*/
	af = 3.0/8.0*I*(I+1)*n*C*t/(d*d*d) * (J0 + 10*J1 + J2);
	return af;
}
/******************************************************************************/
/*									      */
/******************************************************************************/
