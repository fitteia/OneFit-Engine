#include <stdio.h>
#include <math.h>
#include "t1_rot_vold.h"
#include "t1vold_new.h"
#include "t1vold_abc.h"

#define	pi	3.141592653589793238

static double a00_1[][2]={
19.0,	 19.0,
0.00,	.9911,
0.05,	.9911,
0.10,	.9911,
0.15,	.9866,
0.20,	.9821,
0.25,	.9777,
0.30,	.9687,
0.35,	.9598,
0.40,	.9509,
0.45,	.9375,
0.50,	.9152,
0.55,	.8929,
0.60,	.8616,
0.65,	.8080,
0.70,	.7321,
0.75,	.6116,
0.80,	.4196,
0.83,	.2902,
0.85,	.1652
};
static double a00_2[][2]={
23.0,    23.0,
0.10,	.0000,
0.15,	.0045,
0.20,	.0089,
0.25,	.0134,
0.30,	.0179,
0.35,	.0313,
0.40,	.0402,
0.45,	.0536,
0.50,	.0714,
0.55,	.0982,
0.60,	.1339,
0.65,	.1786,
0.70,	.2500,
0.75,	.3571,
0.80,	.4777,
0.83,	.5313,
0.85,	.6429,
0.88,	.7366,
0.90,	.8348,
0.93,	.9018,
0.95,	.9732,
0.98,	.9866,
1.00,	.9955
};
static double a10_1[][2]={
23.0,    23.0,
0.00,	1.000,
0.05,	1.000,
0.10,	.9955,
0.15,	.9955,
0.20,	.9911,
0.25,	.9911,
0.30,	.9866,
0.35,	.9821,
0.40,	.9732,
0.45,	.9643,
0.50,	.9554,
0.55,	.9464,
0.60,	.9330,
0.65,	.9196,
0.70,	.9107,
0.75,	.9062,
0.80,	.9062,
0.85,	.9420,
0.88,	.9687,
0.90,	.9955,
0.93,	1.004,
0.95,	1.009,
0.98,	1.013	
};
static double a10_2[][2]={
17.0,    17.0,
0.10,	.0045,
0.20,	.0089,
0.25,	.0134,
0.30,	.0223,
0.35,	.0268,
0.40,	.0402,
0.45,	.0446,
0.50,	.0580,
0.55,	.0714,
0.60,	.0804,
0.65,	.0937,
0.70,	.1071,
0.75,	.1116,
0.80,	.1071,
0.85,	.0714,
0.88,	.0446,
0.90,	.0268
};
static double a11_1[][2]={
17.0,    17.0,
0.00,	1.000,
0.05,	1.004,
0.10,	.9509,
0.15,	.8973,
0.20,	.8304,
0.25,	.7545,
0.30,	.6786,
0.35,	.5982,
0.40,	.5223,
0.45,	.4464,
0.50,	.3705,
0.55,	.2991,
0.60,	.2321,
0.65,	.1696,
0.70,	.1161,
0.75,	.0625,
0.80,	.0313
};
static double a11_2[][2]={
22.0,    22.0,
0.05,	.0179,
0.10,	.0536,
0.15,	.1071,
0.20,	.1652,
0.25,	.2411,
0.30,	.3125,
0.35,	.3973,
0.40,	.4643,
0.45,	.5357,
0.50,	.6071,
0.55,	.6741,
0.60,	.7366,
0.65,	.7991,
0.70,	.8527,
0.75,	.9018,
0.80,	.9420,
0.85,	.9732,
0.88,	.9821,
0.90,	.9955,
0.93,	1.000,
0.95,	1.004,
0.98,	1.009
};
static double a11_3[][2]={
16.0,    16.0,
0.10,	.0045,
0.20,	.0134,
0.25,	.0179,
0.30,	.0223,
0.35,	.0268,
0.40,	.0313,
0.45,	.0313,
0.50,	.0357,
0.55,	.0446,
0.60,	.0491,
0.65,	.0536,
0.70,	.0580,
0.75,	.0625,
0.80,	.0536,
0.85,	.0357,
0.88,	.0223
};
static double a12_1[][2]={
24.0,    24.0,
0.00,	1.004,
0.05,	1.004,
0.10,	1.004,
0.15,	1.000,
0.20,	1.000,
0.25,	.9955,
0.30,	.9955,
0.35,	.9866,
0.40,	.9821,
0.45,	.9732,
0.50,	.9598,
0.55,	.9464,
0.60,	.9286,
0.65,	.9062,
0.70,	.8750,
0.75,	.8437,
0.80,	.8170,
0.83,	.8170,
0.85,	.8348,
0.88,	.9375,
0.90,	.9955,
0.93,	1.004,
0.95,	1.004,
0.98,	1.009
};
static double a12_2[][2]={
15.0,    15.0,
0.10,	.0000,
0.15,	.0045,
0.20,	.0045,
0.30,	.0045,
0.45,	.0134,
0.50,	.0179,
0.55,	.0268,
0.60,	.0402,
0.65,	.0536,
0.70,	.0804,
0.75,	.1116,
0.80,	.1429,
0.83,	.1473,
0.85,	.1429,
0.88,	.1429
};
static double a12_3[][2]={
16.0,    16.0,
0.10,	.0000,
0.20,	.0045,
0.30,	.0134,
0.35,	.0179,
0.40,	.0223,
0.45,	.0268,
0.50,	.0357,
0.55,	.0402,
0.60,	.0491,
0.65,	.0536,
0.70,	.0580,
0.75,	.0625,
0.80,	.0580,
0.83,	.0446,
0.85,	.0357,
0.88,	.0223
};
static double a20_1[][2]={
19.0,    19.0,
0.00,	1.004,
0.05,	1.009,
0.10,	1.009,
0.15,	1.009,
0.20,	1.004,
0.25,	1.000,
0.30,	.9955,
0.35,	.9866,
0.40,	.9732,
0.45,	.9598,
0.50,	.9375,
0.55,	.9062,
0.60,	.8616,
0.65,	.7991,
0.70,	.7054,
0.75,	.5670,
0.80,	.3616,
0.85,	.1205,
0.88,	.0536
};
static double a20_2[][2]={
23.0,    23.0,
0.00,	.2009,
0.05,	.1920,
0.10,	.1786,
0.15,	.1652,
0.20,	.1518,
0.25,	.1384,
0.30,	.1250,
0.35,	.1161,
0.40,	.1027,
0.45,	.0937,
0.50,	.0848,
0.55,	.0670,
0.60,	.5804,
0.65,	.0491,
0.70,	.0402,
0.75,	.0313,
0.80,	.0268,
0.85,	.0179,
0.88,	.0179,
0.90,	.0134,
0.93,	.0134,
0.95,	.0134,
0.98,	.0134
};
static double a22_1[][2]={
24.0,    24.0,
0.00,	1.009,
0.05,	1.009,
0.10,	1.009,
0.15,	1.009,
0.20,	1.009,
0.25,	1.009,
0.30,	1.009,
0.35,	1.009,
0.40,	1.009,
0.45,	1.009,
0.50,	1.009,
0.55,	1.009,
0.60,	1.009,
0.65,	1.009,
0.70,	1.009,
0.75,	1.009,
0.80,	1.013,
0.83,	1.013,
0.85,	1.013,
0.88,	1.013,
0.90,	1.013,
0.93,	1.013,
0.95,	1.018,
0.98,	1.018
};
static double b00_1[][2]={
20.0,    20.0,
0.00,	1.000,
0.05,	1.031,
0.10,	1.054,
0.15,	1.071,
0.20,	1.076,
0.25,	1.076,
0.30,	1.071,
0.35,	1.058,
0.40,	1.036,
0.45,	1.004,
0.50,	.9687,
0.55,	.9196,
0.60,	.8661,
0.65,	.7902,
0.70,	.7009,
0.75,	.6027,
0.80,	.4286,
0.83,	.3571,
0.85,	.2813,
0.88,	.0759
};
static double b00_2[][2]={
22.0,    22.0,
0.10,	.3080,
0.15,	.3080,
0.20,	.3080,
0.25,	.3080,
0.30,	.3080,
0.35,	.3080,
0.40,	.3080,
0.45,	.3080,
0.50,	.3080,
0.55,	.3036,
0.60,	.2991,
0.65,	.2946,
0.70,	.2857,
0.75,	.2679,
0.80,	.2455,
0.83,	.2232,
0.85,	.2009,
0.88,	.1696,
0.90,	.1339,
0.93,	.0982,
0.95,	.0670,
0.98,	.0313
};
static double b10_1[][2]={
23.0,    23.0,
0.00,	1.000,
0.05,	1.013,
0.10,	1.022,
0.15,	1.022,
0.20,	1.018,
0.25,	1.009,
0.30,	.9911,
0.35,	.9732,
0.40,	.9464,
0.45,	.9107,
0.50,	.8750,
0.55,	.8259,
0.60,	.7723,
0.65,	.7098,
0.70,	.6384,
0.75,	.5491,
0.80,	.4464,
0.85,	.3348,
0.88,	.2768,
0.90,	.2188,
0.93,	.1652,
0.95,	.1161,
0.98,	.0536
};
static double b10_2[][2]={
17.0,    17.0,
0.10,	.3036,
0.20,	.3080,
0.25,	.3080,
0.30,	.3080,
0.35,	.3080,
0.40,	.3080,
0.45,	.3080,
0.50,	.3036,
0.55,	.3036,
0.60,	.2991,
0.65,	.2902,
0.70,	.2813,
0.75,	.2634,
0.80,	.2411,
0.85,	.2009,
0.88,	.1652,
0.90,	.1116
};
static double b11_1[][2]={
17.0,    17.0,
0.00,	1.000,
0.05,	1.004,
0.10,	1.004,
0.15,	.9911,
0.20,	.9732,
0.25,	.9509,
0.30,	.9241,
0.35,	.8973,
0.40,	.8661,
0.45,	.8259,
0.50,	.7902,
0.55,	.7455,
0.60,	.6964,
0.65,	.6384,
0.70,	.5759,
0.75,	.4955,
0.80,	.4107
};
static double b11_2[][2]={
22.0,    22.0,
0.05,	3.107,
0.10,	3.241,
0.15,	3.402,
0.20,	3.563,
0.25,	3.723,
0.30,	3.884,
0.35,	4.071,
0.40,	4.259,
0.45,	4.446,
0.50,	4.661,
0.55,	4.875,
0.60,	5.063,
0.65,	5.250,
0.70,	5.464,
0.75,	5.598,
0.80,	5.759,
0.85,	5.839,
0.88,	5.893,
0.90,	5.920,
0.93,	5.946,
0.95,	5.946,
0.98,	5.946
};
static double b11_3[][2]={
16.0,    16.0,
0.10,	.2991,
0.20,	.3080,
0.25,	.3080,
0.30,	.3036,
0.35,	.2902,
0.40,	.2902,
0.45,	.2857,
0.50,	.2813,
0.55,	.2813,
0.60,	.2723,
0.65,	.2634,
0.70,	.2500,
0.75,	.2321,
0.80,	.2054,
0.85,	.1696,
0.88,	.1384
};
static double b12_1[][2]={
24.0,    24.0,
0.00,	1.000,
0.05,	.9866,
0.10,	.9643,
0.15,	.9509,
0.20,	.9241,
0.25,	.8973,
0.30,	.8705,
0.35,	.8437,
0.40,	.8170,
0.45,	.7813,
0.50,	.7455,
0.55,	.7054,
0.60,	.6607,
0.65,	.6116,
0.70,	.5491,
0.75,	.4777,
0.80,	.3973,
0.83,	.3527,
0.85,	.2991,
0.88,	.2500,
0.90,	.2009,
0.93,	.1563,
0.95,	.1071,
0.98,	.0491
};
static double b12_2[][2]={
13.0,    13.0,
0.30,	.4777,
0.35,	.4688,
0.45,	.3616,
0.50,	.4420,
0.55,	.4286,
0.60,	.4152,
0.65,	.3973,
0.70,	.3750,
0.75,	.3482,
0.80,	.3125,
0.83,	.2902,
0.85,	.2589,
0.88,	.2188
};
static double b12_3[][2]={
18.0,    18.0,
0.10,	.3036,
0.15,	.3036,
0.20,	.2991,
0.25,	.2991,
0.30,	.2991,
0.35,	.2946,
0.40,	.2946,
0.45,	.2902,
0.50,	.2857,
0.55,	.2813,
0.60,	.2723,
0.65,	.2634,
0.70,	.2500,
0.75,	.2321,
0.80,	.2098,
0.83,	.1920,
0.85,	.1696,
0.88,	.1429
};
static double b20_1[][2]={
19.0,    19.0,
0.00,	1.004,
0.05,	.9732,
0.10,	.9375,
0.15,	.9062,
0.20,	.8750,
0.25,	.8393,
0.30,	.8080,
0.35,	.7768,
0.40,	.7411,
0.45,	.7054,
0.50,	.6696,
0.55,	.6295,
0.60,	.5893,
0.65,	.5402,
0.70,	.4911,
0.75,	.4330,
0.80,	.3571,
0.85,	.2857,
0.88,	.2321
};
static double b20_2[][2]={
19.0,    19.0,
0.10,	.3036,
0.20,	.3036,
0.25,	.3036,
0.30,	.3036,
0.35,	.2991,
0.40,	.2991,
0.45,	.2946,
0.50,	.2902,
0.55,	.2857,
0.60,	.2813,
0.65,	.2723,
0.70,	.2589,
0.75,	.2411,
0.80,	.2188,
0.85,	.1786,
0.88,	.1518,
0.90,	.1205,
0.93,	.0893,
0.95,	.0580,
0.98,	.0313
};
static double b22_1[][2]={
23.0,    23.0,
0.00,	1.013,
0.05,	1.045,
0.10,	1.076,
0.15,	1.112,
0.20,	1.143,
0.25,	1.174,
0.30,	1.201,
0.35,	1.228,
0.40,	1.259,
0.45,	1.286,
0.50,	1.313,
0.55,	1.339,
0.60,	1.362,
0.65,	1.388,
0.70,	1.411,
0.75,	1.433,
0.80,	1.451,
0.85,	1.469,
0.88,	1.478,
0.90,	1.482,
0.93,	1.491,
0.95,	1.496,
0.98,	1.500
};
static double c00[][2]={
24.0,    24.0,
0.00,	.2054,
0.05,	.2143,
0.10,	.2232,
0.15,	.2277,
0.20,	.2321,
0.25,	.2366,
0.30,	.2321,
0.35,	.2232,
0.40,	.2143,
0.45,	.2009,
0.50,	.1830,
0.55,	.1652,
0.60,	.1429,
0.65,	.1205,
0.70,	.0982,
0.75,	.0759,
0.80,	.0536,
0.83,	.0446,
0.85,	.0357,
0.88,	.0268,
0.90,	.0223,
0.93,	.0179,
0.95,	.0134,
0.98,	.0134
};
static double c10[][2]={
20.0,    20.0,
0.00,	.2009,
0.05,	.2098,
0.10,	.2143,
0.15,	.2188,
0.20,	.2232,
0.25,	.2277,
0.30,	.2277,
0.35,	.2277,
0.40,	.2277,
0.45,	.2277,
0.50,	.2232,
0.55,	.2188,
0.60,	.2143,
0.65,	.2054,
0.70,	.1920,
0.75,	.1786,
0.80,	.1607,
0.85,	.0714,
0.88,	.0402,
0.90,	.0268
};
static double c11[][2]={
23.0,    23.0,
0.00,	.1964,
0.05,	.2009,
0.10,	.2098,
0.15,	.2143,
0.20,	.2188,
0.25,	.2277,
0.30,	.2366,
0.35,	.2455,
0.40,	.2545,
0.45,	.2634,
0.50,	.2723,
0.55,	.2857,
0.60,	.2991,
0.65,	.3125,
0.70,	.3304,
0.75,	.3482,
0.80,	.3705,
0.85,	.3973,
0.88,	.4107,
0.90,	.4286,
0.93,	.4464,
0.95,	.4598,
0.98,	.4866
};
static double c12[][2]={
24.0,    24.0,
0.00,	.2009,
0.05,	.1920,
0.10,	.1875,
0.15,	.1786,
0.20,	.1741,
0.25,	.1652,
0.30,	.1563,
0.35,	.1473,
0.40,	.1384,
0.45,	.1339,
0.50,	.1250,
0.55,	.1161,
0.60,	.1071,
0.65,	.0982,
0.70,	.0848,
0.75,	.0759,
0.80,	.0670,
0.83,	.0625,
0.85,	.0536,
0.88,	.0491,
0.90,	.0402,
0.93,	.0357,
0.95,	.0268,
0.98,	.0179
};
static double c20[][2]={
23.0,    23.0,
0.00,	.2009,
0.05,	.1875,
0.10,	.1741,
0.15,	.1607,
0.20,	.1473,
0.25,	.1339,
0.30,	.1205,
0.35,	.1116,
0.40,	.1027,
0.45,	.0893,
0.50,	.0804,
0.55,	.0670,
0.60,	.0536,
0.65,	.0446,
0.70,	.0357,
0.75,	.0268,
0.80,	.0223,
0.85,	.0134,
0.88,	.0134,
0.90,	.0089,
0.93,	.0089,
0.95,	.0089,
0.98,	.0089
};
static double c22[][2]={
24.0,    24.0,
0.00,	.2009,
0.05,	.2143,
0.10,	.2321,
0.15,	.2455,
0.20,	.2634,
0.25,	.2768,
0.30,	.2946,
0.35,	.3080,
0.40,	.3259,
0.45,	.3393,
0.50,	.3571,
0.55,	.3705,
0.60,	.3884,
0.65,	.4018,
0.70,	.4152,
0.75,	.4330,
0.80,	.4509,
0.83,	.4598,
0.85,	.4643,
0.88,	.4732,
0.90,	.4821,
0.93,	.4866,
0.95,	.4955,
0.98,	.5045
};

double Szz_old_alex = -1.0;

double	a_a[10][10][10];
double  b_b[10][10][10];
double	c_c[10][10];

/*****************************************************************************/
double T1_rot_vold( double f, double delta, double Szz, double Tau_S, double Tau_L, double k1, double p, double afact0, double afact1, double afact2)
{
	double   t1_ang=0.0,j0,j1,j2;

	/*	printf("%lg %lg %lg %lg %lg %lg %lg\n",f,delta,Szz,Tau_S,Tau_L,k1,p);*/
	rot_vold(f,delta,Szz,Tau_S,Tau_L,k1,p,&t1_ang,&j0,&j1,&j2,
                afact0,afact1,afact2);

	return (double) t1_ang;	

}
/*****************************************************************************/
void    rot_vold( double f, double delta, double S0, double Tau_S, double Tau_L, double k1, double p, double *t1_ang, double *j0, double *j1, double *j2,  double afact0, double afact1, double afact2)
{
	int	i,j,k;
	int	t1vold_new_(),t1vold_abc_();
	double Szz;
	
	Szz=S0;

	if(Szz != Szz_old_alex) {
		for(i=0;i<10;i++) for(j=0;j<10;j++) {
					c_c[i][j]=0.0;
					for(k=0;k<10;k++) 
						a_a[k][j][i]=b_b[k][j][i]=0.0;
					}
		t1vold_abc_(&f,&Szz,a_a,b_b,c_c,a00_1,a00_2,
		    a10_1,a10_2,a11_1,a11_2,a11_3,a12_1,a12_2,a12_3,a20_1,
		    a20_2,a22_1,b00_1,b00_2,b10_1,b10_2,b11_1,b11_2,b11_3,
			    b12_1,b12_2,b12_3,b20_1,b20_2,b22_1,c00,c10,c11,c12,c20,c22
		);							
		Szz_old_alex = Szz;
	} 								

	t1vold_new_(&f,&delta,&Szz,&Tau_S,&Tau_L,&k1,&p,a_a,b_b,c_c,
		t1_ang,j0,j1,j2,&afact0,&afact1,&afact2);
	/*printf("ola\n");*/
}
/*****************************************************************************/
