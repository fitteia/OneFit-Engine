/******************************************************************************/
/*				SDVILFSA5.C				      */
/******************************************************************************/
#include <math.h>
#include <stdio.h>

#define	C	0.569504e-12
#define ndt1	19
#define Ndt	ndt1-1

/*
lsd = 5
asd = 0.5
r2sd2 = 1
DllsDT = 1
*/

static double	jwdev[][3]={
0.000000e+00,6.302320e+00,0.000000e+00,
2.514756e-02,6.575972e+00,-1.240631e+03,
3.556684e-02,6.536063e+00,-2.137206e+00,
7.071068e-02,6.352466e+00,1.353896e+02,
1.000000e-01,6.268321e+00,-1.114549e+02,
1.500000e-01,6.009174e+00,-3.028207e+00,
2.011964e-01,5.674150e+00,-3.867652e+01,
2.845171e-01,4.992630e+00,8.963427e+00,
4.023804e-01,4.039964e+00,1.662920e+00,
5.690694e-01,2.799542e+00,1.106726e+01,
7.071068e-01,1.969800e+00,1.130907e+01,
8.047546e-01,1.511501e+00,1.072426e+01,
1.000000e+00,8.800250e-01,7.007971e+00,
1.138095e+00,6.042762e-01,4.770869e+00,
1.224745e+00,4.807210e-01,3.613941e+00,
1.414214e+00,2.984570e-01,1.976450e+00,
1.581139e+00,2.018170e-01,1.226159e+00,
1.609503e+00,1.893313e-01,8.343463e-01,
2.276181e+00,5.160652e-02,9.973685e-02,
3.219006e+00,1.322799e-02,5.350348e-02
};

/******************************************************************************/
/*									      */
/******************************************************************************/
double sdvilfSa5(I,d,n,t,w,delta)
double I,d,n,t,w,delta;
{
	int	j,i,p;
	double	wt,m,af,*x,*y,*y2,*xx,*yy,ypn;
	double	*dvector();
	void	free_dvector(),dsplint(),dpolint();

	x  = dvector(1,Ndt+1);
	y  = dvector(1,Ndt+1);
	y2 = dvector(1,Ndt+1);

	wt = sqrt(w*t);
	for(j=0,i= -1;j<=Ndt;j++) {
		x[j+1] = jwdev[j][0];
		y[j+1] = jwdev[j][1];
		y2[j+1]= jwdev[j][2];
		if(wt<=x[j+1] && i== -1) i=j+1;
	}
	switch(i) {
		case 1:
			dpolint(x,y,2,wt,&af,&m);
			break;
		case -1:
			af = y[Ndt+1]*x[Ndt+1]*x[Ndt+1]/(w*w);
/*
			xx = &x[Ndt];
			yy = &y[Ndt];
			dpolint(xx-1,yy-1,2,wt,&af,&m);
*/
			break;
		default:
/*
			xx = &x[i];
			yy = &y[i];
			dpolint(xx-1,yy-1,2,wt,&af,&m);
*/
			dsplint(x,y,y2,Ndt+1,wt,&af);			      
			break;
	}
	free_dvector(x,1,Ndt+1);
	free_dvector(y,1,Ndt+1);
	free_dvector(y2,1,Ndt+1);

	af = 1.5*I*(I+1)*n*C*t/(d*d*d) * af;
	return af;
}
/******************************************************************************/
/*									      */
/******************************************************************************/
