/* t1vold_abc_alex.f -- translated by f2c (version 19960717).
   You must link the resulting object file with the libraries:
	-lf2c -lm   (in that order)
*/

#include "/sw/include/f2c.h"

/* Table of constant values */

static integer c__17 = 17;




/* Subroutine */ int t1vold_abc__(s, a, b, c__, a00_1__, a00_2__, a10_1__, 
	a10_2__, a11_1__, a11_2__, a11_3__, a12_1__, a12_2__, a12_3__, 
	a20_1__, a20_2__, a22_1__, b00_1__, b00_2__, b10_1__, b10_2__, 
	b11_1__, b11_2__, b11_3__, b12_1__, b12_2__, b12_3__, b20_1__, 
	b20_2__, b22_1__, c00, c10, c11, c12, c20, c22)
real *s;
doublereal *a, *b, *c__, *a00_1__, *a00_2__, *a10_1__, *a10_2__, *a11_1__, *
	a11_2__, *a11_3__, *a12_1__, *a12_2__, *a12_3__, *a20_1__, *a20_2__, *
	a22_1__, *b00_1__, *b00_2__, *b10_1__, *b10_2__, *b11_1__, *b11_2__, *
	b11_3__, *b12_1__, *b12_2__, *b12_3__, *b20_1__, *b20_2__, *b22_1__, *
	c00, *c10, *c11, *c12, *c20, *c22;
{
    /* System generated locals */
    integer i__1;

    /* Local variables */
    static doublereal ax00_1__[30], ax00_2__[30], ax10_1__[30], ax10_2__[30], 
	    ax11_1__[30], ax11_2__[30], ax11_3__[30], ax12_1__[30], ax12_2__[
	    30], ax12_3__[30], ax20_1__[30], ax20_2__[30], ax22_1__[30], 
	    bx00_1__[30], bx00_2__[30], bx10_1__[30], bx10_2__[30], bx11_1__[
	    30], bx11_2__[30], bx11_3__[30], bx12_1__[30], bx12_2__[30], 
	    bx12_3__[30], bx20_1__[30], bx20_2__[30], bx22_1__[30], ay00_1__[
	    30], ay00_2__[30], ay10_1__[30], ay10_2__[30], ay11_1__[30], 
	    ay11_2__[30], ay11_3__[30], ay12_1__[30], ay12_2__[30], ay12_3__[
	    30], ay20_1__[30], ay20_2__[30], ay22_1__[30], by00_1__[30], 
	    by00_2__[30], by10_1__[30], by10_2__[30], by11_1__[30], by11_2__[
	    30], by11_3__[30], by12_1__[30], by12_2__[30], by12_3__[30], 
	    by20_1__[30], by20_2__[30], by22_1__[30];
    static integer i__;
    static doublereal y2[30];
    static real yy;
    extern /* Subroutine */ int spline_(), splint_();
    static integer np1;
    static real yp1;
    static doublereal cx00[30], cx10[30], cx11[30], cx12[30], cx20[30], cx22[
	    30], cy00[30], cy10[30], cy11[30], cy12[30], cy20[30], cy22[30], 
	    yy20[30], yy21[30], yy22[30], yy23[30], yy24[30], yy25[30], yy26[
	    30], yy27[30], yy28[30], yy29[30], yy30[30], yy31[30], yy32[30], 
	    yy33[30], yy34[30];
    static real szz, ypn;










    /* Parameter adjustments */
    c22 -= 3;
    c20 -= 3;
    c12 -= 3;
    c11 -= 3;
    c10 -= 3;
    c00 -= 3;
    b22_1__ -= 3;
    b20_2__ -= 3;
    b20_1__ -= 3;
    b12_3__ -= 3;
    b12_2__ -= 3;
    b12_1__ -= 3;
    b11_3__ -= 3;
    b11_2__ -= 3;
    b11_1__ -= 3;
    b10_2__ -= 3;
    b10_1__ -= 3;
    b00_2__ -= 3;
    b00_1__ -= 3;
    a22_1__ -= 3;
    a20_2__ -= 3;
    a20_1__ -= 3;
    a12_3__ -= 3;
    a12_2__ -= 3;
    a12_1__ -= 3;
    a11_3__ -= 3;
    a11_2__ -= 3;
    a11_1__ -= 3;
    a10_2__ -= 3;
    a10_1__ -= 3;
    a00_2__ -= 3;
    a00_1__ -= 3;
    c__ -= 11;
    b -= 111;
    a -= 111;

    /* Function Body */
    szz = *s;
    np1 = 0;
/* 	YP1 = 1e31 */
/* 	YPn = 1e31 */
    yp1 = (float)1.;
    ypn = (float)1.;
/* 	type *,'a(1,1,1) in=',a(1,1,1) */
/* --------------------------------------------------------- */
    np1 = (integer) a00_1__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	ax00_1__[i__ - 2] = a00_1__[(i__ << 1) + 1];
	ay00_1__[i__ - 2] = a00_1__[(i__ << 1) + 2];
/* L151: */
    }
    spline_(ax00_1__, ay00_1__, &np1, &yp1, &ypn, yy20);
    splint_(ax00_1__, ay00_1__, yy20, &np1, &szz, &yy);
    a[131] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) a00_2__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	ax00_2__[i__ - 2] = a00_2__[(i__ << 1) + 1];
	ay00_2__[i__ - 2] = a00_2__[(i__ << 1) + 2];
/* L152: */
    }
    spline_(ax00_2__, ay00_2__, &np1, &yp1, &ypn, yy21);
    splint_(ax00_2__, ay00_2__, yy21, &np1, &szz, &yy);
    a[231] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) a10_1__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	ax10_1__[i__ - 2] = a10_1__[(i__ << 1) + 1];
	ay10_1__[i__ - 2] = a10_1__[(i__ << 1) + 2];
/* L153: */
    }
    spline_(ax10_1__, ay10_1__, &np1, &yp1, &ypn, yy22);
    splint_(ax10_1__, ay10_1__, yy22, &np1, &szz, &yy);
    a[132] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) a10_2__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	ax10_2__[i__ - 2] = a10_2__[(i__ << 1) + 1];
	ay10_2__[i__ - 2] = a10_2__[(i__ << 1) + 2];
/* L154: */
    }
    spline_(ax10_2__, ay10_2__, &c__17, &yp1, &ypn, yy23);
    splint_(ax10_2__, ay10_2__, yy23, &c__17, &szz, &yy);
    a[232] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) a11_1__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	ax11_1__[i__ - 2] = a11_1__[(i__ << 1) + 1];
	ay11_1__[i__ - 2] = a11_1__[(i__ << 1) + 2];
/* L155: */
    }
    spline_(ax11_1__, ay11_1__, &np1, &yp1, &ypn, yy24);
    splint_(ax11_1__, ay11_1__, yy24, &np1, &szz, &yy);
    a[142] = yy;
    a[122] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) a11_2__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	ax11_2__[i__ - 2] = a11_2__[(i__ << 1) + 1];
	ay11_2__[i__ - 2] = a11_2__[(i__ << 1) + 2];
/* L156: */
    }
    spline_(ax11_2__, ay11_2__, &np1, &yp1, &ypn, yy25);
    splint_(ax11_2__, ay11_2__, yy25, &np1, &szz, &yy);
    a[242] = yy;
    a[222] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) a11_3__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	ax11_3__[i__ - 2] = a11_3__[(i__ << 1) + 1];
	ay11_3__[i__ - 2] = a11_3__[(i__ << 1) + 2];
/* L157: */
    }
    spline_(ax11_3__, ay11_3__, &np1, &yp1, &ypn, yy26);
    splint_(ax11_3__, ay11_3__, yy26, &np1, &szz, &yy);
    a[342] = yy;
    a[322] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) a12_1__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	ax12_1__[i__ - 2] = a12_1__[(i__ << 1) + 1];
	ay12_1__[i__ - 2] = a12_1__[(i__ << 1) + 2];
/* L158: */
    }
    spline_(ax12_1__, ay12_1__, &np1, &yp1, &ypn, yy27);
    splint_(ax12_1__, ay12_1__, yy27, &np1, &szz, &yy);
    a[152] = yy;
    a[112] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) a12_2__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	ax12_2__[i__ - 2] = a12_2__[(i__ << 1) + 1];
	ay12_2__[i__ - 2] = a12_2__[(i__ << 1) + 2];
/* L159: */
    }
    spline_(ax12_2__, ay12_2__, &np1, &yp1, &ypn, yy28);
    splint_(ax12_2__, ay12_2__, yy28, &np1, &szz, &yy);
    a[252] = yy;
    a[212] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) a12_3__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	ax12_3__[i__ - 2] = a12_3__[(i__ << 1) + 1];
	ay12_3__[i__ - 2] = a12_3__[(i__ << 1) + 2];
/* L161: */
    }
    spline_(ax12_3__, ay12_3__, &np1, &yp1, &ypn, yy29);
    splint_(ax12_3__, ay12_3__, yy29, &np1, &szz, &yy);
    a[352] = yy;
    a[312] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) a20_1__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	ax20_1__[i__ - 2] = a20_1__[(i__ << 1) + 1];
	ay20_1__[i__ - 2] = a20_1__[(i__ << 1) + 2];
/* L162: */
    }
    spline_(ax20_1__, ay20_1__, &np1, &yp1, &ypn, yy30);
    splint_(ax20_1__, ay20_1__, yy30, &np1, &szz, &yy);
    a[133] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) a20_2__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	ax20_2__[i__ - 2] = a20_2__[(i__ << 1) + 1];
	ay20_2__[i__ - 2] = a20_2__[(i__ << 1) + 2];
/* L163: */
    }
    spline_(ax20_2__, ay20_2__, &np1, &yp1, &ypn, yy31);
    splint_(ax20_2__, ay20_2__, yy31, &np1, &szz, &yy);
    a[233] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) a22_1__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	ax22_1__[i__ - 2] = a22_1__[(i__ << 1) + 1];
	ay22_1__[i__ - 2] = a22_1__[(i__ << 1) + 2];
/* L164: */
    }
    spline_(ax22_1__, ay22_1__, &np1, &yp1, &ypn, yy32);
    splint_(ax22_1__, ay22_1__, yy32, &np1, &szz, &yy);
    a[153] = yy;
    a[113] = yy;
/* --------------------------------------------------------- */
/* --------------------------------------------------------- */
    np1 = (integer) b00_2__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	bx00_2__[i__ - 2] = b00_2__[(i__ << 1) + 1];
	by00_2__[i__ - 2] = b00_2__[(i__ << 1) + 2];
/* L172: */
    }
    spline_(bx00_2__, by00_2__, &np1, &yp1, &ypn, yy34);
    splint_(bx00_2__, by00_2__, yy34, &np1, &szz, &yy);
    b[231] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) b00_1__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	bx00_1__[i__ - 2] = b00_1__[(i__ << 1) + 1];
	by00_1__[i__ - 2] = b00_1__[(i__ << 1) + 2];
/* L171: */
    }
    spline_(bx00_1__, by00_1__, &np1, &yp1, &ypn, yy33);
    splint_(bx00_1__, by00_1__, yy33, &np1, &szz, &yy);
    b[131] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) b10_1__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	bx10_1__[i__ - 2] = b10_1__[(i__ << 1) + 1];
	by10_1__[i__ - 2] = b10_1__[(i__ << 1) + 2];
/* L173: */
    }
    spline_(bx10_1__, by10_1__, &np1, &yp1, &ypn, y2);
    splint_(bx10_1__, by10_1__, y2, &np1, &szz, &yy);
    b[132] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) b10_2__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	bx10_2__[i__ - 2] = b10_2__[(i__ << 1) + 1];
	by10_2__[i__ - 2] = b10_2__[(i__ << 1) + 2];
/* L174: */
    }
    spline_(bx10_2__, by10_2__, &np1, &yp1, &ypn, y2);
    splint_(bx10_2__, by10_2__, y2, &np1, &szz, &yy);
    b[232] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) b11_1__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	bx11_1__[i__ - 2] = b11_1__[(i__ << 1) + 1];
	by11_1__[i__ - 2] = b11_1__[(i__ << 1) + 2];
/* L175: */
    }
    spline_(bx11_1__, by11_1__, &np1, &yp1, &ypn, y2);
    splint_(bx11_1__, by11_1__, y2, &np1, &szz, &yy);
    b[142] = yy;
    b[122] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) b11_2__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	bx11_2__[i__ - 2] = b11_2__[(i__ << 1) + 1];
	by11_2__[i__ - 2] = b11_2__[(i__ << 1) + 2];
/* L176: */
    }
    spline_(bx11_2__, by11_2__, &np1, &yp1, &ypn, y2);
    splint_(bx11_2__, by11_2__, y2, &np1, &szz, &yy);
    b[242] = yy;
    b[222] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) b11_3__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	bx11_3__[i__ - 2] = b11_3__[(i__ << 1) + 1];
	by11_3__[i__ - 2] = b11_3__[(i__ << 1) + 2];
/* L177: */
    }
    spline_(bx11_3__, by11_3__, &np1, &yp1, &ypn, y2);
    splint_(bx11_3__, by11_3__, y2, &np1, &szz, &yy);
    b[342] = yy;
    b[322] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) b12_1__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	bx12_1__[i__ - 2] = b12_1__[(i__ << 1) + 1];
	by12_1__[i__ - 2] = b12_1__[(i__ << 1) + 2];
/* L178: */
    }
    spline_(bx12_1__, by12_1__, &np1, &yp1, &ypn, y2);
    splint_(bx12_1__, by12_1__, y2, &np1, &szz, &yy);
    b[152] = yy;
    b[112] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) b12_2__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	bx12_2__[i__ - 2] = b12_2__[(i__ << 1) + 1];
	by12_2__[i__ - 2] = b12_2__[(i__ << 1) + 2];
/* L179: */
    }
    spline_(bx12_2__, by12_2__, &np1, &yp1, &ypn, y2);
    splint_(bx12_2__, by12_2__, y2, &np1, &szz, &yy);
    b[252] = yy;
    b[212] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) b12_3__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	bx12_3__[i__ - 2] = b12_3__[(i__ << 1) + 1];
	by12_3__[i__ - 2] = b12_3__[(i__ << 1) + 2];
/* L181: */
    }
    spline_(bx12_3__, by12_3__, &np1, &yp1, &ypn, y2);
    splint_(bx12_3__, by12_3__, y2, &np1, &szz, &yy);
    b[352] = yy;
    b[312] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) b20_1__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	bx20_1__[i__ - 2] = b20_1__[(i__ << 1) + 1];
	by20_1__[i__ - 2] = b20_1__[(i__ << 1) + 2];
/* L182: */
    }
    spline_(bx20_1__, by20_1__, &np1, &yp1, &ypn, y2);
    splint_(bx20_1__, by20_1__, y2, &np1, &szz, &yy);
    b[133] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) b20_2__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	bx20_2__[i__ - 2] = b20_2__[(i__ << 1) + 1];
	by20_2__[i__ - 2] = b20_2__[(i__ << 1) + 2];
/* L183: */
    }
    spline_(bx20_2__, by20_2__, &np1, &yp1, &ypn, y2);
    splint_(bx20_2__, by20_2__, y2, &np1, &szz, &yy);
    b[233] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) b22_1__[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	bx22_1__[i__ - 2] = b22_1__[(i__ << 1) + 1];
	by22_1__[i__ - 2] = b22_1__[(i__ << 1) + 2];
/* L184: */
    }
    spline_(bx22_1__, by22_1__, &np1, &yp1, &ypn, y2);
    splint_(bx22_1__, by22_1__, y2, &np1, &szz, &yy);
    b[153] = yy;
    b[113] = yy;
/* --------------------------------------------------------- */
/* --------------------------------------------------------- */
    np1 = (integer) c00[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	cx00[i__ - 2] = c00[(i__ << 1) + 1];
	cy00[i__ - 2] = c00[(i__ << 1) + 2];
/* L191: */
    }
    spline_(cx00, cy00, &np1, &yp1, &ypn, y2);
    splint_(cx00, cy00, y2, &np1, &szz, &yy);
    c__[31] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) c10[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	cx10[i__ - 2] = c10[(i__ << 1) + 1];
	cy10[i__ - 2] = c10[(i__ << 1) + 2];
/* L192: */
    }
    spline_(cx10, cy10, &np1, &yp1, &ypn, y2);
    splint_(cx10, cy10, y2, &np1, &szz, &yy);
    c__[32] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) c11[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	cx11[i__ - 2] = c11[(i__ << 1) + 1];
	cy11[i__ - 2] = c11[(i__ << 1) + 2];
/* L193: */
    }
    spline_(cx11, cy11, &np1, &yp1, &ypn, y2);
    splint_(cx11, cy11, y2, &np1, &szz, &yy);
    c__[42] = yy;
    c__[22] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) c12[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	cx12[i__ - 2] = c12[(i__ << 1) + 1];
	cy12[i__ - 2] = c12[(i__ << 1) + 2];
/* L194: */
    }
    spline_(cx12, cy12, &np1, &yp1, &ypn, y2);
    splint_(cx12, cy12, y2, &np1, &szz, &yy);
    c__[52] = yy;
    c__[12] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) c20[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	cx20[i__ - 2] = c20[(i__ << 1) + 1];
	cy20[i__ - 2] = c20[(i__ << 1) + 2];
/* L195: */
    }
    spline_(cx20, cy20, &np1, &yp1, &ypn, y2);
    splint_(cx20, cy20, y2, &np1, &szz, &yy);
    c__[33] = yy;
/* --------------------------------------------------------- */
    np1 = (integer) c22[3];
    i__1 = np1 + 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	cx22[i__ - 2] = c22[(i__ << 1) + 1];
	cy22[i__ - 2] = c22[(i__ << 1) + 2];
/* L196: */
    }
    spline_(cx22, cy22, &np1, &yp1, &ypn, y2);
    splint_(cx22, cy22, y2, &np1, &szz, &yy);
    c__[53] = yy;
    c__[13] = yy;
/* --------------------------------------------------------- */
/*     ola     ........ fim Spline/Splint ........ */
/* --------------------------------------------------------- */

/* 	type *,'a(1,1,1)=',a(1,1,1) */
/* 	do 1000 ii=1,10 */
/* 	   do 1001 jj=1,10 */
/*             do 1002 kk=1,10 */
/* 	type *,'a=',a(ii,jj,kk) */
/* 1002          continue */
/* 1001       continue */
/* 1000	continue */
    return 0;
} /* t1vold_abc__ */




/* Subroutine */ int spline_(x, y, n, yp1, ypn, y2)
doublereal *x, *y;
integer *n;
real *yp1, *ypn;
doublereal *y2;
{
    /* System generated locals */
    integer i__1;

    /* Local variables */
    static integer i__, k;
    static real p;
    static doublereal u[100];
    static real qn, un, sig;

    /* Parameter adjustments */
    --y2;
    --y;
    --x;

    /* Function Body */
    if (*yp1 > (float)9.9e29) {
	y2[1] = (float)0.;
	u[0] = (float)0.;
    } else {
	y2[1] = (float)-.5;
	u[0] = (float)3. / (x[2] - x[1]) * ((y[2] - y[1]) / (x[2] - x[1]) - *
		yp1);
    }
    i__1 = *n - 1;
    for (i__ = 2; i__ <= i__1; ++i__) {
	sig = (x[i__] - x[i__ - 1]) / (x[i__ + 1] - x[i__ - 1]);
	p = sig * y2[i__ - 1] + (float)2.;
	y2[i__] = (sig - (float)1.) / p;
	u[i__ - 1] = (((y[i__ + 1] - y[i__]) / (x[i__ + 1] - x[i__]) - (y[i__]
		 - y[i__ - 1]) / (x[i__] - x[i__ - 1])) * (float)6. / (x[i__ 
		+ 1] - x[i__ - 1]) - sig * u[i__ - 2]) / p;
/* L11: */
    }
    if (*ypn > (float)9.9e29) {
	qn = (float)0.;
	un = (float)0.;
    } else {
	qn = (float).5;
	un = (float)3. / (x[*n] - x[*n - 1]) * (*ypn - (y[*n] - y[*n - 1]) / (
		x[*n] - x[*n - 1]));
    }
    y2[*n] = (un - qn * u[*n - 2]) / (qn * y2[*n - 1] + (float)1.);
    for (k = *n - 1; k >= 1; --k) {
	y2[k] = y2[k] * y2[k + 1] + u[k - 1];
/* L12: */
    }
    return 0;
} /* spline_ */




/* Subroutine */ int splint_(xa, ya, y2a, n, x, y)
doublereal *xa, *ya, *y2a;
integer *n;
real *x, *y;
{
    /* System generated locals */
    real r__1, r__2, r__3, r__4, r__5;

    /* Builtin functions */
    /* Subroutine */ int s_paus();

    /* Local variables */
    static real a, b, h__;
    static integer k, khi, klo;

    /* Parameter adjustments */
    --y2a;
    --ya;
    --xa;

    /* Function Body */
    klo = 1;
    khi = *n;
L1:
    if (khi - klo > 1) {
	k = (khi + klo) / 2;
	if (xa[k] > *x) {
	    khi = k;
	} else {
	    klo = k;
	}
	goto L1;
    }
    h__ = xa[khi] - xa[klo];
    if (h__ == (float)0.) {
	s_paus("Bad XA input.", 13L);
    }
    a = (xa[khi] - *x) / h__;
    b = (*x - xa[klo]) / h__;
/* Computing 3rd power */
    r__1 = a, r__2 = r__1;
/* Computing 3rd power */
    r__3 = b, r__4 = r__3;
/* Computing 2nd power */
    r__5 = h__;
    *y = a * ya[klo] + b * ya[khi] + ((r__2 * (r__1 * r__1) - a) * y2a[klo] + 
	    (r__4 * (r__3 * r__3) - b) * y2a[khi]) * (r__5 * r__5) / (float)
	    6.;
    return 0;
} /* splint_ */

