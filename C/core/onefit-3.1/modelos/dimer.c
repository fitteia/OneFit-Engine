/******************************************************************************/
/*				DIMER.C 				      */
/******************************************************************************/
#include <math.h>
#include <stdio.h>
#include "struct.h"
#include "struf.h"
#include "dimer.h"
#include "lor.h"
#include "fij.h"

#define	pi	3.141592653589793238
#define MAX(a,b) ((a) > (b) ? (a) : (b))
#define MIN(a,b) ((a) < (b) ? (a) : (b))

#define	C	0.569504e-12

/******************************************************************************/
/*									      */
/******************************************************************************/
double dimer(double a0, double a1, double a2, double t, double w, double delta)
// double a0,a1,a2,t,w,delta;
{
	double	j1,j2,af;
	double	fij(),lor();
	
/*	printf("delta=%lg\n",delta); */
	if(delta == 0.0){
		af = a1*lor(t,w) + a2*lor(t,2*w);
	}
	else {
		j1 = fij(1,0,delta)*a0*lor(t,w)+
		     fij(1,1,delta)*a1*lor(t,w)+
		     fij(1,2,delta)*a2*lor(t,w);
		j2 = fij(2,0,delta)*a0*lor(t,2*w)+
		     fij(2,1,delta)*a1*lor(t,2*w)+
		     fij(2,2,delta)*a2*lor(t,2*w);
		af = j1 + j2;		
	}
	return af;
}
/******************************************************************************/
/*									      */
/******************************************************************************/
#undef MAX
#undef MIN
/******************************************************************************/
/*									      */
/******************************************************************************/


