/******************************************************************************/
/*				V&Z11_0.C				      */
/*                                                                            */
/*  Difusao na fase esmetica A: l/d = 11, D||/DT= 0 a/d = 0.5 delta=0 r2/d2=1 */
/******************************************************************************/
#include <math.h>
#include <stdio.h>
#include "sdvilfsa11_0.h"
#include "fitutil.h"
#include "fij.h"

#define	C	0.569504e-12
#define ndt1	34
#define Ndt	ndt1-1

static double	jwdev[][7]={
  1.000e-03,  1.605e+02,  0.000e+00,  1.919e+00,  0.000e+00,  5.807e+00,  0.000e+00,
  1.414e-03,  1.587e+02, -1.471e+07,  1.919e+00, -2.125e+03,  5.807e+00, -5.361e+01,
  2.000e-03,  1.523e+02, -1.706e+07,  1.918e+00, -2.305e+03,  5.807e+00,  7.511e+01,
  2.828e-03,  1.350e+02, -3.316e+06,  1.916e+00, -1.012e+03,  5.807e+00, -3.346e+02,
  3.162e-03,  1.270e+02,  7.500e+06,  1.915e+00,  3.668e+03,  5.807e+00,  1.900e+03,
  4.472e-03,  1.032e+02,  8.837e+06,  1.912e+00, -8.496e+02,  5.808e+00, -1.333e+03,
  6.325e-03,  9.049e+01,  1.295e+06,  1.909e+00,  5.192e+02,  5.808e+00,  4.743e+02,
  8.944e-03,  8.475e+01, -3.588e+03,  1.904e+00, -2.255e+03,  5.807e+00, -1.243e+03,
  1.000e-02,  8.300e+01, -1.545e+05,  1.899e+00,  1.847e+02,  5.805e+00,  5.150e+02,
  1.414e-02,  7.501e+01, -3.389e+03,  1.878e+00, -3.290e+02,  5.801e+00, -2.519e+02,
  2.000e-02,  6.389e+01,  1.506e+05,  1.845e+00,  2.501e+02,  5.790e+00, -1.109e+02,
  2.828e-02,  5.429e+01,  2.480e+04,  1.806e+00,  9.034e+01,  5.770e+00,  1.021e+01,
  3.162e-02,  5.149e+01,  2.550e+04,  1.793e+00, -7.576e+01,  5.761e+00, -1.749e+02,
  4.472e-02,  4.297e+01,  1.653e+04,  1.738e+00,  8.615e+01,  5.714e+00,  2.386e+01,
  6.325e-02,  3.556e+01,  6.636e+03,  1.674e+00,  4.062e-01,  5.644e+00, -1.951e+01,
  8.944e-02,  2.903e+01,  1.788e+02,  1.586e+00, -4.037e+01,  5.532e+00, -6.395e+01,
  1.000e-01,  2.673e+01,  1.353e+02,  1.545e+00, -1.800e+01,  5.477e+00, -3.738e+01,
  1.414e-01,  1.843e+01,  2.147e+03,  1.378e+00,  3.401e+01,  5.242e+00,  4.295e+01,
  2.000e-01,  1.153e+01,  1.034e+03,  1.208e+00,  1.233e+01,  4.981e+00,  4.542e+00,
  2.828e-01,  7.602e+00,  4.841e+01,  1.036e+00, -6.315e+00,  4.644e+00, -1.780e+01,
  3.130e-01,  6.675e+00,  1.241e+02,  9.714e-01,  1.076e+00,  4.502e+00, -4.933e+00,
  4.472e-01,  3.735e+00,  7.743e+01,  7.029e-01,  4.935e+00,  3.831e+00,  2.607e+00,
  7.071e-01,  1.542e+00,  1.230e+01,  3.774e-01,  1.757e+00,  2.619e+00,  2.513e+00,
  8.944e-01,  9.731e-01,  6.876e+00,  2.409e-01,  1.543e+00,  1.869e+00,  5.318e+00,
  1.049e+00,  6.968e-01,  3.053e+00,  1.676e-01,  9.163e-01,  1.376e+00,  5.061e+00,
  1.414e+00,  3.294e-01,  1.285e+00,  7.416e-02,  3.344e-01,  6.416e-01,  2.813e+00,
  2.000e+00,  1.074e-01,  3.396e-01,  2.322e-02,  7.095e-02,  2.033e-01,  6.166e-01,
  2.449e+00,  5.096e-02,  1.423e-01,  1.091e-02,  3.254e-02,  9.559e-02,  2.852e-01,
  2.828e+00,  2.937e-02,  6.272e-02,  6.269e-03,  1.313e-02,  5.492e-02,  1.155e-01,
  3.162e+00,  1.902e-02,  3.691e-02,  4.053e-03,  7.909e-03,  3.550e-02,  6.688e-02,
  3.606e+00,  1.148e-02,  1.290e-02,  2.436e-03,  2.867e-03,  2.118e-02,  2.825e-02,
  3.873e+00,  8.651e-03,  1.440e-02,  1.835e-03,  3.032e-03,  1.595e-02,  2.543e-02,
  4.123e+00,  6.750e-03, -1.890e-03,  1.431e-03, -3.901e-04,  1.244e-02, -3.120e-03,
  4.359e+00,  5.411e-03,  4.156e-02,  1.147e-03,  8.820e-03,  9.972e-03,  7.654e-02
};

/******************************************************************************/
/*									      */
/******************************************************************************/
double sdvilfSa11_0(double I,double d,double n,double t,double w,double delta)
// double I,d,n,t,w,delta;
{
	int	j;
	double	B,D,wt,m,j1,j2,af;

	if(delta == 0.0){
		af = jw11_0(1,t,w) + jw11_0(2,t,2*w);
	}
	else {
		j1 = fij(1,0,delta)*jw11_0(0,t,w)+
		     fij(1,1,delta)*jw11_0(1,t,w)+
		     fij(1,2,delta)*jw11_0(2,t,w);
		j2 = fij(2,0,delta)*jw11_0(0,t,2*w)+
		     fij(2,1,delta)*jw11_0(1,t,2*w)+
		     fij(2,2,delta)*jw11_0(2,t,2*w);
		af = j1 + j2;		
	}
	af = 1.5*I*(I+1)*n*C*t/(d*d*d) * af;
	return af;
}
/******************************************************************************/
/*									      */
/******************************************************************************/
double jw11_0(int k,double t,double w)
// int	k;
// double t,w;
{
	int	j,i,p;
	double	wt,m,af,*x,*y,*y2,*xx,*yy,ypn;

	x  = dvector(1,Ndt+1);
	y  = dvector(1,Ndt+1);
	y2 = dvector(1,Ndt+1);

	wt = sqrt(w*t);
	for(j=0,i= -1;j<=Ndt;j++) {
		x[j+1] = jwdev[j][0];
		y[j+1] = jwdev[j][2*k+1];
		y2[j+1]= jwdev[j][2*k+2];
		if(wt<=x[j+1] && i== -1) i=j+1;
	}
	switch(i) {
		case 1:
			xx = &x[1];
			yy = &y[1];
			dpolint(xx-1,yy-1,2,wt,&af,&m);
			break;
		case -1:
			af = y[Ndt+1]*x[Ndt+1]*x[Ndt+1]/(w*w);
/*
			xx = &x[Ndt];
			yy = &y[Ndt];
			dpolint(xx-1,yy-1,2,wt,&af,&m);
*/
			break;
		default:
			dsplint(x,y,y2,Ndt+1,wt,&af);
			break;
	}
	free_dvector(x,1,Ndt+1);
	free_dvector(y,1,Ndt+1);
	free_dvector(y2,1,Ndt+1);
	return af;
}
/******************************************************************************/
/*									      */
/******************************************************************************/
double	jwd11_0(int i,double t,double w,double delta)
// int	i;
// double	t,w,delta;
{
	int	j;
	double	af;

	for(j=0,af=0.0;j<=2;j++) af += fij(i,j,delta)*jw11_0(j,t,w);
	return af;
}
/******************************************************************************/
/*									      */
/******************************************************************************/
double t1ro11_0(double I,double d,double n,double t,double w,double w0,double delta)
// double I,d,n,t,w,w0,delta;
/* B*(J0(2*w1)+10*J1(w0)+J2(2*w0) */
{
	int	j;
	double	B,D,wt,w0t,w2t,m,J0,J1,J2,af;

	J0 = jwd11_0(0,t,2*w,delta);
	J1 = jwd11_0(1,t,w0,delta);
	J2 = jwd11_0(2,t,2*w0,delta);
	
/*	printf("J0=%lg J1=%lg J2=%lg\n",J0,J1,J2);	*/
	af = 3.0/8.0*I*(I+1)*n*C*t/(d*d*d) * (J0 + 10*J1 + J2);
	return af;
}
/******************************************************************************/
/*									      */
/******************************************************************************/
