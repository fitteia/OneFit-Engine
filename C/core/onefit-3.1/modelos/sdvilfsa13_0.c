/******************************************************************************/
/*				V&Z13_0.C				      */
/*                                                                            */
/*  Difusao na fase esmetica A: l/d = 13, D||/DT= 0 a/d = 0.5 delta=0 r2/d2=1 */
/******************************************************************************/
#include <math.h>
#include <stdio.h>
#include "sdvilfsa13_0.h"
#include "fitutil.h"
#include "fij.h"

#define	C	0.569504e-12
#define ndt1	28
#define Ndt	ndt1-1

static double	jwdev[][7]={
  4.472e-03,  1.028e+02,  0.000e+00,  1.910e+00,  0.000e+00,  5.795e+00,  0.000e+00,
  6.325e-03,  9.017e+01,  3.338e+06,  1.907e+00, -8.306e+01,  5.795e+00, -1.183e+02,
  8.944e-03,  8.444e+01, -7.354e+05,  1.901e+00, -8.011e+02,  5.794e+00, -1.639e+02,
  1.000e-02,  8.270e+01, -7.794e+04,  1.898e+00, -8.209e+02,  5.793e+00, -1.933e+02,
  1.414e-02,  7.473e+01, -2.039e+04,  1.877e+00, -1.190e+02,  5.788e+00, -1.081e+02,
  2.000e-02,  6.362e+01,  1.546e+05,  1.844e+00,  2.435e+02,  5.778e+00, -1.015e+02,
  2.828e-02,  5.405e+01,  2.220e+04,  1.805e+00, -3.565e+01,  5.757e+00, -1.229e+02,
  3.162e-02,  5.124e+01,  2.645e+04,  1.790e+00,  1.802e+01,  5.747e+00, -7.330e+01,
  4.472e-02,  4.274e+01,  1.630e+04,  1.735e+00,  6.840e+01,  5.700e+00,  6.427e+00,
  6.325e-02,  3.535e+01,  6.652e+03,  1.671e+00,  3.923e+00,  5.631e+00, -2.147e+01,
  8.944e-02,  2.884e+01,  1.844e+02,  1.583e+00, -3.689e+01,  5.518e+00, -5.842e+01,
  1.000e-01,  2.655e+01,  1.393e+02,  1.542e+00, -2.262e+01,  5.463e+00, -3.812e+01,
  1.414e-01,  1.829e+01,  2.133e+03,  1.375e+00,  3.570e+01,  5.229e+00,  4.219e+01,
  2.000e-01,  1.142e+01,  1.033e+03,  1.205e+00,  1.156e+01,  4.968e+00,  4.788e+00,
  2.828e-01,  7.511e+00,  5.052e+01,  1.032e+00, -5.544e+00,  4.631e+00, -1.746e+01,
  3.162e-01,  6.501e+00,  1.218e+02,  9.613e-01,  1.080e+00,  4.474e+00, -4.794e+00,
  4.472e-01,  3.679e+00,  8.003e+01,  7.006e-01,  5.133e+00,  3.820e+00,  3.065e+00,
  6.325e-01,  1.878e+00,  2.362e+01,  4.493e-01,  2.232e+00,  2.945e+00,  1.745e+00,
  8.944e-01,  9.539e-01,  4.645e+00,  2.398e-01,  1.499e+00,  1.862e+00,  5.373e+00,
  1.000e+00,  7.575e-01,  3.789e+00,  1.870e-01,  1.036e+00,  1.513e+00,  5.234e+00,
  1.414e+00,  3.251e-01,  1.122e+00,  7.416e-02,  3.209e-01,  6.394e-01,  2.834e+00,
  2.000e+00,  1.062e-01,  3.543e-01,  2.326e-02,  7.172e-02,  2.025e-01,  5.893e-01,
  2.828e+00,  2.904e-02,  3.018e-02,  6.284e-03,  9.179e-03,  5.472e-02,  9.263e-02,
  3.162e+00,  1.880e-02,  3.278e-02,  4.063e-03,  6.845e-03,  3.537e-02,  5.826e-02,
  4.472e+00,  4.753e-03,  1.324e-03,  1.027e-03,  3.381e-04,  8.963e-03,  3.215e-03,
  6.325e+00,  1.193e-03,  8.251e-04,  2.577e-04,  1.663e-04,  2.249e-03,  1.389e-03,
  8.944e+00,  2.986e-04, -1.340e-04,  6.448e-05, -2.435e-05,  5.626e-04, -1.889e-04,
  1.000e+01,  1.911e-04,  2.476e-04,  4.127e-05,  5.119e-05,  3.601e-04,  4.349e-04
};

/******************************************************************************/
/*									      */
/******************************************************************************/
double sdvilfSa13_0(double I,double d,double n,double t,double w,double delta)
// double I,d,n,t,w,delta;
{
	int	j;
	double	B,D,wt,m,j1,j2,af;

	if(delta == 0.0){
		af = jw13_0(1,t,w) + jw13_0(2,t,2*w);
	}
	else {
		j1 = fij(1,0,delta)*jw13_0(0,t,w)+
		     fij(1,1,delta)*jw13_0(1,t,w)+
		     fij(1,2,delta)*jw13_0(2,t,w);
		j2 = fij(2,0,delta)*jw13_0(0,t,2*w)+
		     fij(2,1,delta)*jw13_0(1,t,2*w)+
		     fij(2,2,delta)*jw13_0(2,t,2*w);
		af = j1 + j2;		
	}
	af = 1.5*I*(I+1)*n*C*t/(d*d*d) * af;
	return af;
}
/******************************************************************************/
/*									      */
/******************************************************************************/
double jw13_0(int k,double t,double w)
// int	k;
// double t,w;
{
	int	j,i,p;
	double	wt,m,af,*x,*y,*y2,*xx,*yy,ypn;

	x  = dvector(1,Ndt+1);
	y  = dvector(1,Ndt+1);
	y2 = dvector(1,Ndt+1);

	wt = sqrt(w*t);
	for(j=0,i= -1;j<=Ndt;j++) {
		x[j+1] = jwdev[j][0];
		y[j+1] = jwdev[j][2*k+1];
		y2[j+1]= jwdev[j][2*k+2];
		if(wt<=x[j+1] && i== -1) i=j+1;
	}
	switch(i) {
		case 1:
			xx = &x[1];
			yy = &y[1];
			dpolint(xx-1,yy-1,2,wt,&af,&m);
			break;
		case -1:
			af = y[Ndt+1]*x[Ndt+1]*x[Ndt+1]/(w*w);
/*
			xx = &x[Ndt];
			yy = &y[Ndt];
			dpolint(xx-1,yy-1,2,wt,&af,&m);
*/
			break;
		default:
			dsplint(x,y,y2,Ndt+1,wt,&af);
			break;
	}
	free_dvector(x,1,Ndt+1);
	free_dvector(y,1,Ndt+1);
	free_dvector(y2,1,Ndt+1);
	return af;
}
/******************************************************************************/
/*									      */
/******************************************************************************/
double	jwd11(int i,double t,double w,double delta)
// int	i;
// double	t,w,delta;
{
	int	j;
	double	af;

	for(j=0,af=0.0;j<=2;j++) af += fij(i,j,delta)*jw13_0(j,t,w);
	return af;
}
/******************************************************************************/
/*									      */
/******************************************************************************/
double t1ro11(double I,double d,double n,double t,double w,double w0,double delta)
// double I,d,n,t,w,w0,delta;
/* B*(J0(2*w1)+10*J1(w0)+J2(2*w0) */
{
	int	j;
	double	B,D,wt,w0t,w2t,m,J0,J1,J2,af;

	J0 = jwd11(0,t,2*w,delta);
	J1 = jwd11(1,t,w0,delta);
	J2 = jwd11(2,t,2*w0,delta);
	
/*	printf("J0=%lg J1=%lg J2=%lg\n",J0,J1,J2);	*/
	af = 3.0/8.0*I*(I+1)*n*C*t/(d*d*d) * (J0 + 10*J1 + J2);
	return af;
}
/******************************************************************************/
/*									      */
/******************************************************************************/
