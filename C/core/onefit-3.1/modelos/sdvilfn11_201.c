/******************************************************************************/
/*				SDVILFN11_201.C				      */
/******************************************************************************/
#include <math.h>
#include <stdio.h>
#include "sdvilfn11_201.h"
#include "fitutil.h"

#define	C	0.569504e-12
#define ndt1	40
#define Ndt	ndt1-1

/*
                           vsdn
lsd = 11
asd = 0.5
r2sd2 = 0.1
DllsDT = 2
*/

static double	jwdev[][3]={
1.000000e-02,3.861874e+00,0.000000e+00,
1.732051e-02,3.861859e+00,-6.969255e-01,
2.236068e-02,3.861829e+00,-1.228112e+00,
2.645751e-02,3.861783e+00,-1.391534e+00,
3.000000e-02,3.861723e+00,-2.247657e+00,
3.162278e-02,3.861687e+00,-2.053702e+00,
5.477226e-02,3.860174e+00,-6.637070e+00,
7.071068e-02,3.857154e+00,-1.118855e+01,
8.366600e-02,3.852639e+00,-1.557768e+01,
1.000000e-01,3.843099e+00,-2.178551e+01,
1.414214e-01,3.788466e+00,-3.955668e+01,
1.732051e-01,3.702691e+00,-4.985638e+01,
2.000000e-01,3.592513e+00,-5.153395e+01,
2.236068e-01,3.465458e+00,-4.620395e+01,
2.449490e-01,3.328736e+00,-3.627189e+01,
2.645751e-01,3.188505e+00,-2.422406e+01,
2.828427e-01,3.049532e+00,-1.244702e+01,
3.000000e-01,2.915187e+00,-6.434245e-01,
3.464102e-01,2.556788e+00,2.029750e+01,
3.741657e-01,2.359335e+00,2.412821e+01,
4.000000e-01,2.192280e+00,2.849170e+01,
4.242641e-01,2.051009e+00,1.594897e+01,
4.472136e-01,1.930915e+00,5.831363e+01,
5.477226e-01,1.634585e+00,-1.051290e+01,
6.324555e-01,1.421374e+00,7.387520e+00,
7.071068e-01,1.253811e+00,2.221442e+00,
7.745967e-01,1.118246e+00,3.446932e+00,
8.366600e-01,1.006188e+00,2.831434e+00,
8.944272e-01,9.119917e-01,2.718136e+00,
9.486833e-01,8.317327e-01,2.499177e+00,
1.000000e+00,7.625858e-01,2.254277e+00,
1.414214e+00,3.886494e-01,1.064747e+00,
1.732051e+00,2.433942e-01,5.721685e-01,
2.000000e+00,1.700335e-01,3.381201e-01,
2.236068e+00,1.268763e-01,2.188581e-01,
2.449490e+00,9.885405e-02,1.524376e-01,
2.645751e+00,7.945357e-02,1.176345e-01,
2.828427e+00,6.535537e-02,6.007625e-02,
3.000000e+00,5.390681e-02,-7.921201e-03,
3.162278e+00,4.524222e-02,4.620628e-01

/*
1.000000e-02,3.861874e+01,0.000000e+00,
1.732051e-02,3.861859e+01,-6.969255e+00,
2.236068e-02,3.861829e+01,-1.228112e+01,
2.645751e-02,3.861783e+01,-1.391534e+01,
3.000000e-02,3.861723e+01,-2.247657e+01,
3.162278e-02,3.861687e+01,-2.053702e+01,
5.477226e-02,3.860174e+01,-6.637070e+01,
7.071068e-02,3.857154e+01,-1.118855e+02,
8.366600e-02,3.852639e+01,-1.557768e+02,
1.000000e-01,3.843099e+01,-2.178551e+02,
1.414214e-01,3.788466e+01,-3.955668e+02,
1.732051e-01,3.702691e+01,-4.985638e+02,
2.000000e-01,3.592513e+01,-5.153395e+02,
2.236068e-01,3.465458e+01,-4.620395e+02,
2.449490e-01,3.328736e+01,-3.627189e+02,
2.645751e-01,3.188505e+01,-2.422406e+02,
2.828427e-01,3.049532e+01,-1.244702e+02,
3.000000e-01,2.915187e+01,-6.434245e+00,
3.464102e-01,2.556788e+01,2.029750e+02,
3.741657e-01,2.359335e+01,2.412821e+02,
4.000000e-01,2.192280e+01,2.849170e+02,
4.242641e-01,2.051009e+01,1.594897e+02,
4.472136e-01,1.930915e+01,5.831363e+02,
5.477226e-01,1.634585e+01,-1.051290e+02,
6.324555e-01,1.421374e+01,7.387520e+01,
7.071068e-01,1.253811e+01,2.221442e+01,
7.745967e-01,1.118246e+01,3.446932e+01,
8.366600e-01,1.006188e+01,2.831434e+01,
8.944272e-01,9.119917e+00,2.718136e+01,
9.486833e-01,8.317327e+00,2.499177e+01,
1.000000e+00,7.625858e+00,2.254277e+01,
1.414214e+00,3.886494e+00,1.064747e+01,
1.732051e+00,2.433942e+00,5.721685e+00,
2.000000e+00,1.700335e+00,3.381201e+00,
2.236068e+00,1.268763e+00,2.188581e+00,
2.449490e+00,9.885405e-01,1.524376e+00,
2.645751e+00,7.945357e-01,1.176345e+00,
2.828427e+00,6.535537e-01,6.007625e-01,
3.000000e+00,5.390681e-01,-7.921201e-02,
3.162278e+00,4.524222e-01,4.620628e+00
*/
};

/******************************************************************************/
/*									      */
/******************************************************************************/
double sdvilfN11_201(double I,double d,double n,double t,double w,double delta)
// double I,d,n,t,w,delta;
{
	int	j,i,p;
	double	wt,m,af,*x,*y,*y2,*xx,*yy,ypn;

	x  = dvector(1,Ndt+1);
	y  = dvector(1,Ndt+1);
	y2 = dvector(1,Ndt+1);

	wt = sqrt(w*t);
	for(j=0,i= -1;j<=Ndt;j++) {
		x[j+1] = jwdev[j][0];
		y[j+1] = jwdev[j][1];
		y2[j+1]= jwdev[j][2];
		if(wt<=x[j+1] && i== -1) i=j+1;
	}
	switch(i) {
		case 1:
			dpolint(x,y,2,wt,&af,&m);
			break;
		case -1:
			af = y[Ndt+1]*x[Ndt+1]*x[Ndt+1]/(w*w);
/*
			xx = &x[Ndt];
			yy = &y[Ndt];
			dpolint(xx-1,yy-1,2,wt,&af,&m);
*/
			break;
		default:
			xx = &x[i];
			yy = &y[i];
			dpolint(xx-1,yy-1,2,wt,&af,&m);

/*			dsplint(x,y,y2,Ndt+1,wt,&af);			      */
			break;
	}
	free_dvector(x,1,Ndt+1);
	free_dvector(y,1,Ndt+1);
	free_dvector(y2,1,Ndt+1);

	af = 1.5*I*(I+1)*n*C*t/(d*d*d) * af;
	return af;
}
/******************************************************************************/
/*									      */
/******************************************************************************/
