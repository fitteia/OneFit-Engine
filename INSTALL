#!/usr/bin/env bash
git stash
git pull
pv=`perl -MConfig -e 'print $Config{archlib}' | awk -F'/' '{print $NF}'`
arch=`arch`
root="$PWD"

if [ $1 = "set" ]; then
    echo "install source in $PWD and binaries in $bindir, with perl version: $pv" 
    make MROOT=$root ARCH=$arch PERLVERSION=$pv set
else
    echo "install source in $PWD and binaries in $bindir, with perl version: $pv" 
    make MROOT=$root ARCH=$arch PERLVERSION=$pv install
fi;
echo $1
if [ $1 = "--/test" ]; then
    zef -v --/test install ./ 
else
    zef -v install ./
fi
